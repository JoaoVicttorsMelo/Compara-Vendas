<div align="center"> <h1>ğŸ“Š DataSync - SincronizaÃ§Ã£o de Vendas entre Lojas e Retaguarda</h1> <img src="https://img.shields.io/badge/Ruby-2.7%2B-red" alt="Ruby Version"> <img src="https://img.shields.io/badge/License-MIT-green" alt="License"> <img src="https://img.shields.io/badge/Status-Em%20Desenvolvimento-orange" alt="Status"> </div> <div> <h2>ğŸ“ DescriÃ§Ã£o</h2> <p><strong>DataSync</strong> Ã© uma aplicaÃ§Ã£o em Ruby que realiza a sincronizaÃ§Ã£o de dados de vendas entre as lojas e a retaguarda. Ela compara os valores de vendas diÃ¡rias, gera relatÃ³rios em Excel das discrepÃ¢ncias encontradas e envia e-mails de notificaÃ§Ã£o para as equipes responsÃ¡veis. O objetivo Ã© garantir a consistÃªncia dos dados entre os sistemas locais das lojas e o sistema central de retaguarda.</p> </div> <div> <h2>ğŸš€ Funcionalidades</h2> <ul> <li>ğŸ”— <strong>ConexÃ£o com Bancos de Dados</strong>: Conecta-se aos bancos de dados SQLite (local), SQL Server das lojas e SQL Server da retaguarda.</li> <li>ğŸ“ <strong>ExecuÃ§Ã£o de Scripts SQL</strong>: Executa consultas SQL seguras nas bases de dados para obter os valores de vendas.</li> <li>ğŸ“Š <strong>ComparaÃ§Ã£o de Valores</strong>: Compara os valores de vendas das lojas com os valores da retaguarda para identificar discrepÃ¢ncias.</li> <li>ğŸ“ˆ <strong>GeraÃ§Ã£o de RelatÃ³rios</strong>: Gera relatÃ³rios em Excel (<code>.xlsx</code>) com as diferenÃ§as encontradas utilizando o mÃ³dulo <code>gerar_excel.rb</code> e a gem <code>write_xlsx</code>.</li> <li>âœ‰ï¸ <strong>Envio de E-mails</strong>: Envia e-mails com os relatÃ³rios em anexo para as equipes responsÃ¡veis.</li> <li>â° <strong>Agendamento de Tarefas</strong>: Pode ser configurado para enviar e-mails a cada 30 minutos atÃ© que todas as lojas tenham sido processadas.</li> </ul> </div> <div> <h2>ğŸ› ï¸ Tecnologias Utilizadas</h2> <ul> <li><strong>Linguagem</strong>: <img src="https://img.shields.io/badge/-Ruby-red" alt="Ruby"> Ruby 2.7+</li> <li><strong>Banco de Dados</strong>: SQLite, SQL Server</li> <li><strong>gems</strong>: <ul> <li><code>sqlite3</code>: InteraÃ§Ã£o com o banco de dados SQLite.</li> <li><code>tiny_tds</code>: ConexÃ£o com bancos de dados SQL Server.</li> <li><code>write_xlsx</code>: GeraÃ§Ã£o de relatÃ³rios em Excel.</li> <li><code>yaml</code>: Carregamento de arquivos de configuraÃ§Ã£o.</li> <li><code>time</code>: ManipulaÃ§Ã£o de datas e horas.</li> </ul> </li> </ul> </div> <div> <h2>ğŸ“‹ PrÃ©-requisitos</h2> <ul> <li>Ruby instalado na versÃ£o 2.7 ou superior.</li> <li>Acesso aos bancos de dados SQLite e SQL Server.</li> <li>ConfiguraÃ§Ã£o adequada do arquivo <code>config.yml</code> com as credenciais de acesso aos bancos de dados.</li> <li>ConfiguraÃ§Ã£o do mÃ³dulo <code>EnviarEmail</code> com as credenciais do servidor SMTP.</li> <li>DependÃªncias instaladas listadas no <code>Gemfile</code>.</li> </ul> </div> <div> <h2>ğŸ”§ InstalaÃ§Ã£o</h2> <ol> <li> <p><strong>Clone o repositÃ³rio</strong>:</p> <pre><code>git clone https://github.com/JoaoVicttorsMelo/Compara-Vendas.git cd datasync </code></pre> </li> <li> <p><strong>Instale as dependÃªncias</strong>:</p> <pre><code>bundle install</code></pre> </li> <li> <p><strong>Configure o arquivo <code>config.yml</code></strong>:</p> <p>Crie um arquivo <code>config.yml</code> na raiz do projeto com as seguintes informaÃ§Ãµes:</p> <pre><code>database_server: username: 'seu_usuario' password: 'sua_senha' database: - 'nome_banco_loja' - 'nome_banco_loja_alternativo' database_ret: username: 'seu_usuario_ret' password: 'sua_senha_ret' host: 'endereco_do_servidor_ret' database: 'nome_banco_ret' </code></pre> <p>Certifique-se de substituir os valores pelas credenciais reais.</p> </li> <li> <p><strong>Configure o mÃ³dulo <code>EnviarEmail</code></strong>:</p> <p>No arquivo <code>enviar_email.rb</code>, configure as credenciais do servidor SMTP:</p> <pre><code># enviar_email.rb
module EnviarEmail require 'net/smtp'

Configure aqui suas credenciais SMTP
SMTP_SETTINGS = { address: 'smtp.seuprovedor.com', port: 587, domain: 'seudominio.com', user_name: 'seu_usuario', password: 'sua_senha', authentication:
, enable_starttls_auto: true }

Resto do cÃ³digo...
end </code></pre> </li>

</ol> </div> <div> <h2>ğŸš€ Uso</h2> <ol> <li> <p><strong>Executando a SincronizaÃ§Ã£o de Dados</strong>:</p> <p>VocÃª pode executar o script principal para iniciar o processo de sincronizaÃ§Ã£o:</p> <pre><code>ruby main.rb</code></pre> <p>Onde <code>main.rb</code> Ã© o arquivo que instancia a classe <code>Config</code> e chama o mÃ©todo <code>datasync</code>.</p> </li> <li> <p><strong>Agendamento de Tarefas</strong>:</p> <p>Para agendar o envio de e-mails a cada 30 minutos, vocÃª pode utilizar o <code>cron</code> do sistema ou uma gem como <code>rufus-scheduler</code>.</p> <p><strong>Exemplo usando <code>cron</code></strong>:</p> <p>Edite o crontab:</p> <pre><code>crontab -e</code></pre> <p>Adicione a seguinte linha para executar o script a cada 30 minutos:</p> <pre><code>*/30 * * * * /usr/bin/ruby /caminho/para/seu_projeto/main.rb</code></pre> </li> <li> <p><strong>Visualizando os RelatÃ³rios</strong>:</p> <p>Os relatÃ³rios gerados serÃ£o salvos na raiz do projeto com o nome <code>relatorio_venda.xlsx</code>.</p> </li> </ol> </div> <div> <h2>ğŸ—‚ï¸ Estrutura do Projeto</h2> <pre><code>datasync/ â”œâ”€â”€ config.yml â”œâ”€â”€ main.rb â”œâ”€â”€ config.rb â”œâ”€â”€ gerar_excel.rb â”œâ”€â”€ enviar_email.rb â”œâ”€â”€ relatorio_venda.xlsx â”œâ”€â”€ Gemfile â””â”€â”€ README.md </code></pre> <ul> <li><code>config.yml</code>: Arquivo de configuraÃ§Ã£o com as credenciais de acesso aos bancos de dados.</li> <li><code>main.rb</code>: Script principal que inicia o processo de sincronizaÃ§Ã£o.</li> <li><code>config.rb</code>: ContÃ©m a classe <code>Config</code> com os mÃ©todos de conexÃ£o e sincronizaÃ§Ã£o.</li> <li><code>gerar_excel.rb</code>: MÃ³dulo responsÃ¡vel pela geraÃ§Ã£o dos relatÃ³rios em Excel.</li> <li><code>enviar_email.rb</code>: MÃ³dulo responsÃ¡vel pelo envio de e-mails.</li> <li><code>relatorio_venda.xlsx</code>: Arquivo Excel gerado com o relatÃ³rio das discrepÃ¢ncias.</li> <li><code>Gemfile</code>: Lista de gems necessÃ¡rias para o projeto.</li> <li><code>README.md</code>: Este arquivo.</li> </ul> </div> <div> <h2>âœ¨ Funcionalidades Detalhadas</h2> <h3>ğŸ”— ConexÃ£o com Bancos de Dados</h3> <p><strong>SQLite</strong>: Utilizado para armazenar dados locais ou temporÃ¡rios necessÃ¡rios para o processo.</p> <p><strong>SQL Server (Lojas)</strong>: Conecta-se aos bancos de dados das lojas para obter os valores de vendas.</p> <p><strong>SQL Server (Retaguarda)</strong>: Conecta-se ao banco de dados central para obter os valores de vendas consolidados.</p> <h3>ğŸ“ ExecuÃ§Ã£o de Scripts SQL</h3> <p>Executa consultas SQL seguras nos bancos de dados. Utiliza uma lista de scripts permitidos para evitar a execuÃ§Ã£o de comandos nÃ£o autorizados.</p> <h3>ğŸ“Š ComparaÃ§Ã£o de Valores</h3> <p>Compara os valores de vendas obtidos das lojas com os valores da retaguarda. Identifica diferenÃ§as que possam indicar problemas de sincronizaÃ§Ã£o ou erros nos sistemas.</p> <h3>ğŸ“ˆ GeraÃ§Ã£o de RelatÃ³rios</h3> <p>O mÃ³dulo <code>gerar_excel.rb</code> Ã© responsÃ¡vel por gerar um arquivo Excel com as seguintes informaÃ§Ãµes:</p> <ul> <li><strong>Filial</strong></li> <li><strong>Valor na Loja</strong></li> <li><strong>Valor na Retaguarda</strong></li> <li><strong>DiferenÃ§a</strong></li> </ul> <p>Aplica formataÃ§Ãµes para melhorar a legibilidade, como cores e formataÃ§Ã£o condicional.</p> <h3>âœ‰ï¸ Envio de E-mails</h3> <p>O mÃ³dulo <code>enviar_email.rb</code> envia e-mails automÃ¡ticos com o relatÃ³rio em anexo para uma lista de destinatÃ¡rios. Notifica sobre as lojas que nÃ£o puderam ser processadas ou que apresentaram erros.</p> </div> <div> <h2>âš™ï¸ ConfiguraÃ§Ã£o</h2> <h3>Arquivo <code>config.yml</code></h3> <p>Certifique-se de configurar corretamente o arquivo <code>config.yml</code> com as credenciais e informaÃ§Ãµes necessÃ¡rias para acessar os bancos de dados.</p> <h3>MÃ³dulo <code>gerar_excel.rb</code></h3> <p>O mÃ³dulo <code>gerar_excel.rb</code> utiliza a gem <code>write_xlsx</code> para criar relatÃ³rios em Excel. Certifique-se de que a gem estÃ¡ instalada e que o mÃ³dulo estÃ¡ corretamente referenciado em seu cÃ³digo.</p> <h3>MÃ³dulo <code>EnviarEmail</code></h3> <p>Configure o mÃ³dulo <code>enviar_email.rb</code> com as informaÃ§Ãµes do servidor SMTP, porta, usuÃ¡rio, senha e demais parÃ¢metros necessÃ¡rios para o envio de e-mails.</p> </div> <div> <h2>ğŸ¤ ContribuiÃ§Ã£o</h2> <p>ContribuiÃ§Ãµes sÃ£o bem-vindas! Sinta-se Ã  vontade para abrir <strong>issues</strong> e <strong>pull requests</strong>.</p> <ol> <li>FaÃ§a um <strong>fork</strong> do projeto.</li> <li>Crie uma nova branch: <code>git checkout -b feature/nova-funcionalidade</code>.</li> <li>Commit suas alteraÃ§Ãµes: <code>git commit -m 'Adiciona nova funcionalidade'</code>.</li> <li>FaÃ§a um push para a branch: <code>git push origin feature/nova-funcionalidade</code>.</li> <li>Abra um <strong>pull request</strong>.</li> </ol> </div> <div> <h2>ğŸ“„ LicenÃ§a</h2> <p>Este projeto estÃ¡ sob a licenÃ§a <a href="LICENSE">MIT</a>.</p> </div> <div> <h2>ğŸ“ Contato</h2> <p>âœ‰ï¸ Email: <a href="mailto:joaovicttorsilveiramelo@gmail.com">joaovicttorsilveiramelo@gmail.com</a></p> </div>
